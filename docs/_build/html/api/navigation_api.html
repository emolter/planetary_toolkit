<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Rings API" href="rings_api.html" /><link rel="prev" title="pylanetary API" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Navigation API - pylanetary documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #002f87;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #00a7e1;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #00a7e1;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pylanetary  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">pylanetary  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/body-tutorial.html">Planetary Body Attributes &amp; Ephemerides</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/nav-tutorial.html">Navigation Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/nav-examples.html">Navigation Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rings-tutorial.html">Rings Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/unit-conversions.html">Unit Conversions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">pylanetary API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of pylanetary API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Navigation API</a></li>
<li class="toctree-l2"><a class="reference internal" href="rings_api.html">Rings API</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils_api.html">Utils API</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-pylanetary.navigation.core">
<span id="navigation-api"></span><h1>Navigation API<a class="headerlink" href="#module-pylanetary.navigation.core" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">ModelBody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody" title="Link to this definition">#</a></dt>
<dd><p>Wrapper to ModelEllipsoid that permits passing an ephemeris</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>body</strong> (<em>pylanetary.utils.Body object</em><em>, </em><em>required</em>) – </p></li>
<li><p><strong>pixscale</strong> (<em>float</em><em> or </em><em>Quantity</em><em>, </em><em>required.</em>) – [arcsec/px] pixel scale of the input image</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – shape of output arrays.
if None, shape is just larger than diameter / pixscale</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody.body">
<span class="sig-name descname"><span class="pre">body</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody.body" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pylanetary.utils.Body object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody.name" title="Link to this definition">#</a></dt>
<dd><p>Name of input body as read from input Body object</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody.ephem">
<span class="sig-name descname"><span class="pre">ephem</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody.ephem" title="Link to this definition">#</a></dt>
<dd><p>single line of astroquery.horizons ephemeris
as read from utils.Body object.
must have ‘PDObsLon’, ‘PDObsLat’, ‘delta’, and ‘NPole_ang’ fields.
If you want to modify the ephemeris, modify body.ephem</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Astropy QTable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody.pixscale_arcsec">
<span class="sig-name descname"><span class="pre">pixscale_arcsec</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody.pixscale_arcsec" title="Link to this definition">#</a></dt>
<dd><p>[arcsec/px] pixel scale of image; see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelBody.pixscale_km">
<span class="sig-name descname"><span class="pre">pixscale_km</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelBody.pixscale_km" title="Link to this definition">#</a></dt>
<dd><p>[km/px] pixel scale of image computed from input pixel scale in arcsec
and distance from object to body according to body.ephem</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">all</span> <span class="pre">attrs</span> <span class="pre">from</span> <span class="pre">ModelEllipsoid</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">ModelEllipsoid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale_km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">req</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rpol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">0.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sun_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid" title="Link to this definition">#</a></dt>
<dd><p>Projection of an ellipsoid onto a 2-D array with latitude and longitude grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ob_lon</strong> (<em>float</em><em>, </em><em>required.</em>) – [deg] sub-observer planetographic longitude</p></li>
<li><p><strong>ob_lat</strong> (<em>float</em><em>, </em><em>required.</em>) – [deg] sub-observer planetographic latitude</p></li>
<li><p><strong>np_ang</strong> (<em>float</em><em>, </em><em>required.</em>) – [deg] north polar angle
see JPL Horizons ephemeris tool for detailed descriptions
of ob_lon, ob_lat, np_ang</p></li>
<li><p><strong>pixscale_km</strong> (<em>float</em><em>, </em><em>required.</em>) – [km] pixel scale</p></li>
<li><p><strong>req</strong> (<em>float</em><em>, </em><em>required.</em>) – [km] equatorial radius</p></li>
<li><p><strong>rpol</strong> (<em>float</em><em>, </em><em>required.</em>) – [km] polar radius</p></li>
<li><p><strong>center</strong> (<em>2-element array-like</em><em>, </em><em>optional</em><em>, </em><em>default</em><em> (</em><em>0</em><em>,</em><em>0</em><em>)</em><em>.</em>) – pixel offset of center of planet from center of image</p></li>
<li><p><strong>shape</strong> (<em>2-element tuple</em><em>, </em><em>optional.</em>) – shape of output arrays.
if None, shape is just larger than diameter / pixscale</p></li>
<li><p><strong>sun_lon</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – sub-solar longitude. if None, assume same as ob_lon</p></li>
<li><p><strong>sun_lat</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – sub_solar latitude. if None, assume same as ob_lat</p></li>
<li><p><strong>longitude_convention</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default 'w'</em>) – east or west longitude convention</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.req">
<span class="sig-name descname"><span class="pre">req</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.req" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.rpol">
<span class="sig-name descname"><span class="pre">rpol</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.rpol" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.ob_lon">
<span class="sig-name descname"><span class="pre">ob_lon</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.ob_lon" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.ob_lat">
<span class="sig-name descname"><span class="pre">ob_lat</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.ob_lat" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.sun_lon">
<span class="sig-name descname"><span class="pre">sun_lon</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.sun_lon" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.sun_lat">
<span class="sig-name descname"><span class="pre">sun_lat</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.sun_lat" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.pixscale_km">
<span class="sig-name descname"><span class="pre">pixscale_km</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.pixscale_km" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.deg_per_px">
<span class="sig-name descname"><span class="pre">deg_per_px</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.deg_per_px" title="Link to this definition">#</a></dt>
<dd><p>approximate size of pixel on planet, in degrees, at sub-observer point</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.lat_g">
<span class="sig-name descname"><span class="pre">lat_g</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.lat_g" title="Link to this definition">#</a></dt>
<dd><p>shape is roughly 2*max(req, rpol)/pixscale.
planetographic latitudes. NaN where off planet disk</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.lon_w">
<span class="sig-name descname"><span class="pre">lon_w</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.lon_w" title="Link to this definition">#</a></dt>
<dd><p>same shape as lat_g. west longitudes. NaN where off planet disk</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.mu" title="Link to this definition">#</a></dt>
<dd><p>same shape as lat_g. cosines of the emission angle. NaN where off planet disk</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.surf_n">
<span class="sig-name descname"><span class="pre">surf_n</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.surf_n" title="Link to this definition">#</a></dt>
<dd><p>shape (3,x,y) CHECK THIS. Normal vector to the surface
of the planet at each pixel. NaN where off planet disk</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.sun_n">
<span class="sig-name descname"><span class="pre">sun_n</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.sun_n" title="Link to this definition">#</a></dt>
<dd><p>shape (3,x,y), solar normal vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.mu0">
<span class="sig-name descname"><span class="pre">mu0</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.mu0" title="Link to this definition">#</a></dt>
<dd><p>shape (x,y), cosine of solar incidence angle at each pixel</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.image_grid_km_x">
<span class="sig-name descname"><span class="pre">image_grid_km_x</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.image_grid_km_x" title="Link to this definition">#</a></dt>
<dd><p>shape (x,y), x-coordinates of image grid in km, where 0 is center of planet</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.image_grid_km_y">
<span class="sig-name descname"><span class="pre">image_grid_km_y</span></span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.image_grid_km_y" title="Link to this definition">#</a></dt>
<dd><p>shape (x,y), y-coordinates of image grid in km, where 0 is center of planet</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>see notebooks/planetnav-tutorial.ipynb</p>
<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.ldmodel">
<span class="sig-name descname"><span class="pre">ldmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">law</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.ldmodel" title="Link to this definition">#</a></dt>
<dd><p>Make a limb-darkened model disk convolved with the beam
See docstring of limb_darkening() for options</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tb</strong> (<em>float</em><em>, </em><em>required.</em>) – [flux] brightness temperature of disk at mu=1</p></li>
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>tuple</em><em>, </em><em>required.</em>) – [-] limb darkening parameter(s)</p></li>
<li><p><strong>beam</strong> (<em>float</em><em> or </em><em>tuple</em><em> or </em><em>np.array</em>) – units pixels. see docstring of utils.convolve_with_beam</p></li>
<li><p><strong>law</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;exp&quot;</em>) – limb darkening law</p></li>
<li><p><strong>mu0</strong> (<em>np.array</em><em>, </em><em>optional</em><em>, </em><em>default None</em>) – cosine of solar incidence angle.
if None, code will check if self.mu0 is defined, and use that
has no effect unless law==”minnaert”.
if self.mu0 undefined, law==”minnaert”, and mu0=None, then
code will fail</p></li>
<li><p><strong>psf_mode</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;gaussian&quot;</em>) – mode to use for convolve_with_beam(), options “airy”, “gaussian”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.ModelEllipsoid.zonalmodel">
<span class="sig-name descname"><span class="pre">zonalmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.ModelEllipsoid.zonalmodel" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">Nav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav" title="Link to this definition">#</a></dt>
<dd><p>Build the model body object,
and compare a model ellipsoid with observed 2-d imaging data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em><em>, </em><em>required.</em>) – 2-D image data</p></li>
<li><p><strong>body</strong> (<em>pylanetary.utils.Body object</em><em>, </em><em>required.</em>) – </p></li>
<li><p><strong>pixscale</strong> (<em>float</em><em> or </em><em>Quantity</em><em>, </em><em>required.</em>) – [arcsec] pixel scale of the input image</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pylanetary.navigation.core.Nav.data" title="Link to this definition">#</a></dt>
<dd><p>see parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.parent_attrs">
<span class="sig-name descname"><span class="pre">parent_attrs</span></span><a class="headerlink" href="#pylanetary.navigation.core.Nav.parent_attrs" title="Link to this definition">#</a></dt>
<dd><p>all attributes of ModelBody and ModelEllipsoid classes</p>
</dd></dl>

<p class="rubric">Examples</p>
<p>see notebooks/nav-tutorial.ipynb</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Need to test astropy quantity handling, ensure docstring reflects what really happens</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.colocate">
<span class="sig-name descname"><span class="pre">colocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'convolution'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostic_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.colocate" title="Link to this definition">#</a></dt>
<dd><p>Co-locate the model planet with the observed planet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional. Default 'convolution'.</em>) – <p>Which method should be used to overlay planet model and data. Choices are:</p>
<ul>
<li><dl class="simple">
<dt>’canny’: uses the Canny edge detection algorithm.</dt><dd><dl class="simple">
<dt>kwargs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">tb<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
[same flux unit as data] brightness temperature of disk at mu=1</p>
</dd>
<dt class="field-even">a<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
[-] exponential limb darkening param</p>
</dd>
<dt class="field-odd">law<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default ‘exp’
type of limb darkening model to use</p>
</dd>
<dt class="field-even">beam<span class="colon">:</span></dt>
<dd class="field-even"><p>float, tuple, or np.array, optional. default None.
units pixels. see utils.convolve_with_beam</p>
</dd>
<dt class="field-odd">psf_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default “gaussian”
what beam shape to use, options “airy”, “gaussian”</p>
</dd>
<dt class="field-even">low_thresh<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
see documentation of skimage.feature.canny</p>
</dd>
<dt class="field-odd">high_thresh<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
see documentation of skimage.feature.canny</p>
</dd>
<dt class="field-even">sigma<span class="colon">:</span></dt>
<dd class="field-even"><p>int, required.
see documentation of skimage.feature.canny</p>
</dd>
</dl>
</dd>
<dt>To find edges of planet disk, typical “good” values are:</dt><dd><p>low_thresh : RMS noise in image
high_thresh : approximate flux value of background disk (i.e., cloud-free, volcano-free region)
sigma : 5</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’convolution’: takes the shift that maximizes the convolution of model and planet</dt><dd><dl class="simple">
<dt>kwargs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">tb<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, required.
[same flux unit as data] brightness temperature of disk at mu=1</p>
</dd>
<dt class="field-even">a<span class="colon">:</span></dt>
<dd class="field-even"><p>float, required.
[-] limb darkening parameter</p>
</dd>
<dt class="field-odd">law<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default ‘exp’
type of limb darkening model to use</p>
</dd>
<dt class="field-even">beam<span class="colon">:</span></dt>
<dd class="field-even"><p>float, tuple, or np.array, optional. default None.
units pixels. see utils.convolve_with_beam</p>
</dd>
<dt class="field-odd">psf_mode<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional. default “gaussian”
what beam shape to use, options “airy”, “gaussian”</p>
</dd>
<dt class="field-even">err<span class="colon">:</span></dt>
<dd class="field-even"><p>float
per-pixel error in input image</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p>’disk’: same as convolution</p></li>
</ul>
</p></li>
<li><p><strong>diagnostic_plot</strong> (<em>bool</em><em>, </em><em>optional. default True</em>) – do you want the diagnostic plots to be shown</p></li>
<li><p><strong>save_plot</strong> (<em>str</em><em>, </em><em>optional. default None.</em>) – file path to save the diagnostic plot. if None, does not save.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>float</em> – dx in pixels. best-fit difference in position between model and data
To shift data to center (i.e., colocated with model), apply a shift of -dx, -dy
To shift model to data, apply a shift of dx, dy</p></li>
<li><p><em>float</em> – dy in pixels</p></li>
<li><p><em>float</em> – dxerr in pixels uncertainty in the shift based on the cross-correlation
from image_registration.chi2_shift. These should be treated with extreme caution
because they were designed to work on identical images corrupted by random
noise, and are being used for non-identical images (model and data)</p></li>
<li><p><em>float</em> – dyerr in pixels</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>need at least one example of each mode here</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>sometimes dxerr, dyerr give unrealistic or undefined behavior</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.reproject">
<span class="sig-name descname"><span class="pre">reproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'equirectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.reproject" title="Link to this definition">#</a></dt>
<dd><p>Projects the navigated data into the target projection
This function only works properly if self.lat_g and self.lon_w
are centered with respect to self.data; for instance,
if ONE of xy_shift_data or xy_shift_model has been applied
using the dx, dy output of colocate()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em> or </em><em>cartopy.proj.Projection instance</em><em>, </em><em>optional. default 'equirectangular'</em>) – string options are [‘equirectangular’, ‘polar’]
Equirectangular, AKA rectilinear, projection results in pixels equally spaced in latitude and longitude
Polar projection will be applied on whichever pole is closest to the sub-observer latitude
any cartopy Projection object is also accepted, but in this case shape must be specified
see <a class="reference external" href="https://scitools.org.uk/cartopy/docs/v0.15/crs/projections.html">cartopy projection list</a>.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>optional. default None</em>) – shape of output arrays.
if None, shape is guessed from pixel scale of input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – the projected data</p></li>
<li><p><em>np.array</em> – cosine of the emission angle (mu)
at each pixel in the projection</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outstem</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.write" title="Link to this definition">#</a></dt>
<dd><p>Writes navigated data to multi-extension fits</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outstem</strong> (<em>str</em><em>, </em><em>required.</em>) – stem of filenames to write</p></li>
<li><p><strong>header</strong> (<em>dict</em><em>, </em><em>optional</em><em>, </em><em>default {}</em>) – dictionary of header info to put into hdul[0].header</p></li>
<li><p><strong>flux_unit</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default &quot;&quot;</em>) – unit of flux to put in output fits header</p></li>
<li><p><strong>Writes</strong> – </p></li>
<li><p><strong>------</strong> – </p></li>
<li><p><strong>file</strong> (<em>fits</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>hdul[0] contains the header, data is empty
hdul[1] contains the data
hdul[2] contains latitudes
hdul[3] contains longitudes
hdul[4] contains emission angles
hdul[5] contains solar incidence angles</p>
<p class="rubric">References</p>
<p>NAV multi-extension fits file format originally pioneered by Mike Wong
e.g. <a class="reference external" href="https://doi.org/10.3847/1538-4365/ab775f">https://doi.org/10.3847/1538-4365/ab775f</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.xy_shift_data">
<span class="sig-name descname"><span class="pre">xy_shift_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.xy_shift_data" title="Link to this definition">#</a></dt>
<dd><p>FFTshift data by a user-defined amount
for example, to apply the suggested shift from colocate()
it is preferred to use xy_shift_model() instead, which avoids
touching the data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in x</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pylanetary.navigation.core.Nav.xy_shift_model">
<span class="sig-name descname"><span class="pre">xy_shift_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.Nav.xy_shift_model" title="Link to this definition">#</a></dt>
<dd><p>shift model (i.e., lat_g, lon_w, mu, and mu0)
by recalculating the model with a different center
as defined by user-defined dx, dy shift</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in x</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>required</em>) – [pixels] shift in y</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.colocate_diagnostic_plot">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">colocate_diagnostic_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.colocate_diagnostic_plot" title="Link to this definition">#</a></dt>
<dd><p>assesses goodness-of-fit of navigation solution from colocate</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>np.array</em><em>, </em><em>required</em>) – shifted model data</p></li>
<li><p><strong>data</strong> (<em>np.array</em><em>, </em><em>required</em>) – observed data</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>required</em>) – method of co-location, one of [“canny”, “convolution”, or “disk”]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib figure and axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.emission_angle">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">emission_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surf_n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.emission_angle" title="Link to this definition">#</a></dt>
<dd><p>Computes the cosine of the emission angle of surface wrt observer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ob_lat</strong> (<em>float</em><em> or </em><em>np.array</em><em>, </em><em>required.</em>) – [deg] sub-observer latitude</p></li>
<li><p><strong>surf_n</strong> (<em>np.array</em><em>, </em><em>required.</em>) – [x,y,z] surface normal vector at each ob_lat</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cosine of emission angle</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.lat_lon">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">lat_lon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale_km</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_ang</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_convention</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.lat_lon" title="Link to this definition">#</a></dt>
<dd><p>Computes the planetographic and planetocentric latitudes and west longitudes
of an ellipsoidal planet as viewed from a tilted perspective, i.e., on the sky
For now, this relies on manually de-rotating the planet and using Cartopy’s
orthographic projection, because pyproj TiltedPerspective cannot handle
ellipsoidal planets, only spheres.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em>, </em><em>required</em>) – shape of output arrays</p></li>
<li><p><strong>pixscale_km</strong> (<em>float</em><em>, </em><em>required</em>) – [km/px] pixel scale of image</p></li>
<li><p><strong>ob_lon</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer planetographic longitude</p></li>
<li><p><strong>ob_lat</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer planetographic latitude</p></li>
<li><p><strong>np_ang</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] north polar angle</p></li>
<li><p><strong>r_e</strong> (<em>float</em><em>, </em><em>required</em>) – [km] equatorial radius of planet</p></li>
<li><p><strong>r_p</strong> (<em>float</em><em>, </em><em>required</em>) – [km] polar radius of planet</p></li>
<li><p><strong>dx</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default 0</em>) – [px] offset in x from the center of the image</p></li>
<li><p><strong>dy</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default 0</em>) – [px] offset in y from the center of the image</p></li>
<li><p><strong>longitude_convention</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default 'w'</em>) – east or west longitude convention</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>np.array</em> – planetographic latitudes</p></li>
<li><p><em>np.array</em> – planetocentric latitudes</p></li>
<li><p><em>np.array</em> – West longitudes</p></li>
<li><p><em>np.array</em> – x-coordinates of image grid in km, where 0 is center of planet</p></li>
<li><p><em>np.array</em> – y-coordinates of image grid in km, where 0 is center of planet</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.limb_darkening">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">limb_darkening</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">law</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.limb_darkening" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>required.</em>) – [-] cosine of emission angle</p></li>
<li><p><strong>a</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>required.</em>) – [-] limb-darkening parameter(s)
if law==”disc”, a is ignored
if law==”exp”, “linear”, or “minnaert”, a must have length 1
if law==”quadratic”, “square-root”, a must have length 2 such that [a0, a1] are
the free parameters in the first and second terms, respectively.</p></li>
<li><p><strong>law</strong> (<em>str</em><em>, </em><em>optional. default &quot;exp&quot;.</em>) – what type of limb darkening law to use. options are:
disc : no limb darkening applied
linear : ld = 1 - a * (1 - mu)
exp : ld = mu**a
minnaert : ld = mu0**a * mu**(a-1)
quadratic : ld = 1 - a[0]*(1-mu) - a[1]*(1-mu)**2
square-root : ld = 1 - a[0]*(1-mu) - a[1]*(1-np.sqrt(mu))</p></li>
<li><p><strong>mu0</strong> (<em>float</em><em> or </em><em>array-like</em><em>, </em><em>optional. default None.</em>) – [-] cosine of solar incidence angle.
has no effect unless law==”minnaert”, in which case it is required.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>limb-darkening value at each input mu value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.array</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Overview of published limb darkening laws
<a class="reference external" href="https://www.astro.keele.ac.uk/jkt/codes/jktld.html">https://www.astro.keele.ac.uk/jkt/codes/jktld.html</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.rotate_about_pivot">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">rotate_about_pivot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pivot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.rotate_about_pivot" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em><em>, </em><em>required</em>) – image to rotate</p></li>
<li><p><strong>angle</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] angle to rotate image (counterclockwise)</p></li>
<li><p><strong>pivot</strong> (<em>tuple</em><em>, </em><em>required</em>) – [px] (x,y) coordinates of pivot point about which to rotate image</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rotated image</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pylanetary.navigation.core.surface_normal">
<span class="sig-prename descclassname"><span class="pre">pylanetary.navigation.core.</span></span><span class="sig-name descname"><span class="pre">surface_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat_g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ob_lon</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pylanetary.navigation.core.surface_normal" title="Link to this definition">#</a></dt>
<dd><p>Computes the normal vector to the surface of the planet.
Take dot product with sub-obs or sub-sun vector to find cosine of emission angle</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat_g</strong> (<em>np.array</em><em>, </em><em>required</em>) – [deg] planetographic latitude</p></li>
<li><p><strong>lon_w</strong> (<em>np.array</em><em>, </em><em>required</em>) – [deg] west longitude</p></li>
<li><p><strong>ob_lon</strong> (<em>float</em><em>, </em><em>required</em>) – [deg] sub-observer (or sub-sun) planetographic longitude</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[x,y,z] normal vector to the surface of the planet</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="rings_api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Rings API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">pylanetary API</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Navigation API</a><ul>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody"><code class="docutils literal notranslate"><span class="pre">ModelBody</span></code></a><ul>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody.body"><code class="docutils literal notranslate"><span class="pre">ModelBody.body</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody.name"><code class="docutils literal notranslate"><span class="pre">ModelBody.name</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody.ephem"><code class="docutils literal notranslate"><span class="pre">ModelBody.ephem</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody.pixscale_arcsec"><code class="docutils literal notranslate"><span class="pre">ModelBody.pixscale_arcsec</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelBody.pixscale_km"><code class="docutils literal notranslate"><span class="pre">ModelBody.pixscale_km</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid</span></code></a><ul>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.req"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.req</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.rpol"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.rpol</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.ob_lon"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.ob_lon</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.ob_lat"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.ob_lat</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.sun_lon"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.sun_lon</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.sun_lat"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.sun_lat</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.pixscale_km"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.pixscale_km</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.deg_per_px"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.deg_per_px</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.lat_g"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.lat_g</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.lon_w"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.lon_w</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.mu"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.mu</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.surf_n"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.surf_n</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.sun_n"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.sun_n</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.mu0"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.mu0</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.image_grid_km_x"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.image_grid_km_x</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.image_grid_km_y"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.image_grid_km_y</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.ldmodel"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.ldmodel()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.ModelEllipsoid.zonalmodel"><code class="docutils literal notranslate"><span class="pre">ModelEllipsoid.zonalmodel()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav"><code class="docutils literal notranslate"><span class="pre">Nav</span></code></a><ul>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.data"><code class="docutils literal notranslate"><span class="pre">Nav.data</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.parent_attrs"><code class="docutils literal notranslate"><span class="pre">Nav.parent_attrs</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.colocate"><code class="docutils literal notranslate"><span class="pre">Nav.colocate()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.reproject"><code class="docutils literal notranslate"><span class="pre">Nav.reproject()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.write"><code class="docutils literal notranslate"><span class="pre">Nav.write()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.xy_shift_data"><code class="docutils literal notranslate"><span class="pre">Nav.xy_shift_data()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.Nav.xy_shift_model"><code class="docutils literal notranslate"><span class="pre">Nav.xy_shift_model()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pylanetary.navigation.core.colocate_diagnostic_plot"><code class="docutils literal notranslate"><span class="pre">colocate_diagnostic_plot()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.emission_angle"><code class="docutils literal notranslate"><span class="pre">emission_angle()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.lat_lon"><code class="docutils literal notranslate"><span class="pre">lat_lon()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.limb_darkening"><code class="docutils literal notranslate"><span class="pre">limb_darkening()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.rotate_about_pivot"><code class="docutils literal notranslate"><span class="pre">rotate_about_pivot()</span></code></a></li>
<li><a class="reference internal" href="#pylanetary.navigation.core.surface_normal"><code class="docutils literal notranslate"><span class="pre">surface_normal()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>